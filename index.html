<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>PineScripter ‚Äî Markets ‚Ä¢ Crypto ‚Ä¢ FX ‚Ä¢ Scripts</title>

  <!-- Chart.js for charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- TradingView widgets -->
  <script src="https://s3.tradingview.com/tv.js"></script>

  <!-- Prism for PineScript syntax -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-pine.min.js"></script>

  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
<header class="topbar">
  <div class="wrap">
    <div class="brand">
      <div class="logo">üìú PineScripter</div>
      <div class="subtitle">Tech ‚Ä¢ Trading ‚Ä¢ Data</div>
    </div>
    <div class="actions">
      <input id="search" placeholder="Search scripts, tags or code‚Ä¶"/>
      <select id="categoryFilter"><option value="">All categories</option></select>
      <input id="tagFilter" placeholder="Filter tags e.g. trend, ema"/>
      <button id="newScriptBtn" class="btn subtle">+ Add (local)</button>
    </div>
  </div>
</header>

<main class="wrap">
  <!-- ===== MARKET SNAPSHOT ===== -->
  <section class="grid-top">
    <div class="card small">
      <h4>Market Snapshot</h4>
      <div class="row">
        <select id="tvSymbol">
          <option value="NSE:NIFTY">NSE:NIFTY</option>
          <option value="NSE:BANKNIFTY">NSE:BANKNIFTY</option>
          <option value="NSE:RELIANCE">NSE:RELIANCE</option>
          <option value="NSE:HDFCBANK">NSE:HDFCBANK</option>
          <option value="NASDAQ:AAPL">NASDAQ:AAPL</option>
          <option value="NASDAQ:TSLA">NASDAQ:TSLA</option>
        </select>
        <a href="./market.html" class="btn subtle" style="text-decoration:none">Open full view ‚Üí</a>
      </div>
      <div id="tv-widget" style="margin-top:8px;"></div>
      <small class="muted">Tip: change the list in <code>scripts.js</code> ‚Üí <code>TV_DEFAULTS</code>.</small>
    </div>

    <div class="card small">
      <h4>Crypto (7-day)</h4>
      <div class="metric">
        <div><strong id="btcPrice">‚Äî</strong><div class="muted">BTC (USD)</div></div>
        <div><strong id="ethPrice">‚Äî</strong><div class="muted">ETH (USD)</div></div>
      </div>
      <canvas id="cryptoChart" height="120"></canvas>
    </div>

    <div class="card small">
      <h4>Forex</h4>
      <div class="metric">
        <div><strong id="usdInr">‚Äî</strong><div class="muted">USD ‚Üí INR</div></div>
        <div><strong id="eurInr">‚Äî</strong><div class="muted">EUR ‚Üí INR</div></div>
      </div>
      <canvas id="fxChart" height="120"></canvas>
    </div>
  </section>

  <!-- ===== CONTENT ===== -->
  <section class="main-area">
    <aside class="left-col">
      <div class="card">
        <h4>Scripts Library</h4>
        <div class="controls-row">
          <button id="sortTrending" class="btn subtle">Sort: Trending</button>
          <div class="muted">Loaded: <span id="scriptCount">0</span></div>
        </div>
        <div id="grid"></div>
        <div id="pager" class="pager"></div>
        <small class="muted">To bulk-load thousands, upload <code>/data/scripts.json</code> (format shown in <code>scripts.js</code>).</small>
      </div>
    </aside>

    <section class="right-col">
      <div class="card">
        <h4>Tech & Market News</h4>
        <div id="newsList"></div>
        <small class="muted">Live via Hacker News API (works on GitHub Pages). For mainstream news you‚Äôll need a small server/proxy due to CORS.</small>
      </div>

      <div class="card">
        <h4>Site Analytics (Local)</h4>
        <p class="muted">Local view counts drive ‚ÄúTrending‚Äù. Add GA4/Plausible later for real analytics.</p>
        <canvas id="popularityChart" height="160"></canvas>
      </div>
    </section>
  </section>
</main>

<!-- Modal -->
<div id="modal" class="modal" aria-hidden="true">
  <div class="modal-body">
    <button id="close" class="close">‚úï</button>
    <h2 id="mTitle"></h2>
    <p id="mDesc" class="muted"></p>
    <div id="mTags" class="tags"></div>
    <pre><code id="mCode" class="language-pine"></code></pre>
    <div class="modal-actions">
      <button id="copyBtn" class="btn primary">Copy Code</button>
      <a id="openTV" class="btn subtle" target="_blank" rel="noopener">Open in TradingView</a>
    </div>
  </div>
</div>

<div id="toast" class="toast">Copied</div>

<script src="scripts.js"></script>
</body>
</html>
